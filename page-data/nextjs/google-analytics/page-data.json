{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/nextjs/google-analytics/",
    "result": {"data":{"posts":{"edges":[{"node":{"id":"ffc7da47-bfde-53c5-bd70-ff2fb28d6cd2","html":"<h1>ë“¤ì–´ê°€ë©°</h1>\n<p>Next í”„ë¡œì íŠ¸ì—ì„œ react-ga ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ <strong>Google Analyticsë¥¼ ì ìš©í•˜ê³  ì›¹ ì‚¬ì´íŠ¸ ì¡°íšŒìˆ˜ë¥¼ ì•Œì•„ë³´ëŠ” ë°©ë²•</strong>ì— ëŒ€í•´ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. React í”„ë¡œì íŠ¸ì—ì„œ GAë¥¼ ì ìš©í•  ë•Œ <code>react-ga</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì¥ ë§ì´ ì‚¬ìš©í•œë‹¤ê³  í•©ë‹ˆë‹¤. ê·¸ëŸ°ë° GA ì¶”ì  ì½”ë“œ í˜•ì‹ì´ <code>UA-XXXXXXXXX-X</code>ì—ì„œ <code>G-XXXXXXXXXX</code>ìœ¼ë¡œ ë³€ê²½ëœ í›„ <code>react-ga</code>ì—ì„œ ìµœì‹  ì¶”ì  ì½”ë“œ í˜•ì‹ì„ ì§€ì›í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ GAë¥¼ ì ìš©í•˜ê³  ì´ 5ë‹¨ê³„ë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. <code>Next.js</code> í”„ë¡œì íŠ¸ì´ë©° <code>TypeScript</code>ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ë°°í¬ í™˜ê²½ì€ <code>Vercel</code>ì…ë‹ˆë‹¤.</p>\n<h2>[1] .env.local íŒŒì¼ì— Google Analytics ì¶”ì  ì½”ë“œ ì‘ì„±í•˜ê¸°</h2>\n<p><code>.env.local</code> íŒŒì¼ì— GA ì¶”ì  ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ì „, ì£¼ì˜í•˜ì‹¤ ì ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>ë°”ë¡œ <code>.gitignore</code> íŒŒì¼ì— <code>.env.local</code> íŒŒì¼ì´ ì í˜€ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n</blockquote>\n<p><code>.gitignore</code> íŒŒì¼ì— ê¸°ë³¸ì ìœ¼ë¡œ <code>.env.local</code> íŒŒì¼ì´ ì í˜€ìˆì§€ë§Œ, ì‹¤ìˆ˜ë¡œ <code>.env.local</code> íŒŒì¼ì„ commit í•  ì¼ ì—†ë„ë¡ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•˜ì‹œëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. GA ì¶”ì  ì½”ë“œë¥¼ â€œcodeâ€ë¼ê³  í•  ë•Œ <code>.env.local</code> íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">NEXT_PUBLIC_GOOGLE_ANALYTICS=&quot;code&quot;</code>\n        </deckgo-highlight-code>\n<h2>[2] _document.tsx íŒŒì¼ì— Google Analytics Code ì¶”ê°€í•˜ê¸°</h2>\n<p><code>pages</code> í´ë” <code>_document.tsx</code> íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì¶”ê°€í•˜ë©´ GA ì¶”ì  ì½”ë“œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. JavaScript í”„ë¡œì íŠ¸ì—ì„œë„ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>\n<p><strong>pages/_document.tsx</strong></p>\n<deckgo-highlight-code language=\"tsx\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">return (\n  &lt;Html&gt;\n    &lt;Head&gt;\n      &lt;script\n        async\n        src={`https://www.googletagmanager.com/gtag/js?id=${process.env.NEXT_PUBLIC_GOOGLE_ANALYTICS}`}\n      /&gt;\n      &lt;script\n        dangerouslySetInnerHTML={{\n          __html: `\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag(&#39;js&#39;, new Date());\n        gtag(&#39;config&#39;, &#39;${process.env.NEXT_PUBLIC_GOOGLE_ANALYTICS}&#39;, {\n          page_path: window.location.pathname,\n        });\n      `,\n        }}\n      /&gt;\n    &lt;/Head&gt;\n    &lt;body&gt;\n      &lt;Main /&gt;\n      &lt;NextScript /&gt;\n    &lt;/body&gt;\n  &lt;/Html&gt;\n);</code>\n        </deckgo-highlight-code>\n<h2>[3] ì¡°íšŒìˆ˜ë¥¼ ì¸¡ì •í•˜ëŠ” í•¨ìˆ˜ ìƒì„±í•˜ê¸°</h2>\n<p><code>lib/ga</code> í´ë” <code>index.ts</code> íŒŒì¼ì— í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. TypeScriptì—ì„œ <code>window</code> ê°ì²´ì— <code>property</code>ë¥¼ ì¶”ê°€í•  ë•Œ íƒ€ì…ì„ ì •ì˜í•˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤. ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ì—ëŸ¬ë¥¼ í•´ê²°í•  ìˆ˜ ìˆì§€ë§Œ, ê·¸ì¤‘ ì „ì—­ íƒ€ì…ì„ í™•ì¥í•´ì„œ í•´ê²°í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</p>\n<p><strong>lib/ga/index.ts</strong></p>\n<deckgo-highlight-code language=\"ts\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">declare global {\n  interface Window {\n    gtag: (param1: string, param2: string, param3: object) =&gt; void;\n  }\n}\n\nexport const pageview = url =&gt; {\n  window.gtag(&#39;config&#39;, process.env.NEXT_PUBLIC_GOOGLE_ANALYTICS, {\n    page_path: url,\n  });\n};</code>\n        </deckgo-highlight-code>\n<p>JavaScript í”„ë¡œì íŠ¸ì—ì„œëŠ” íƒ€ì… ì •ì˜ ë¶€ë¶„ì„ ì œì™¸í•˜ê³  ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>\n<p><strong>lib/ga/index.js</strong></p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">export const pageview = url =&gt; {\n  window.gtag(&#39;config&#39;, process.env.NEXT_PUBLIC_GOOGLE_ANALYTICS, {\n    page_path: url,\n  });\n};</code>\n        </deckgo-highlight-code>\n<h2>[4] ì¡°íšŒìˆ˜ ì¸¡ì •í•˜ê¸°</h2>\n<p><code>pages</code> í´ë” <code>_app.tsx</code> íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì¶”ê°€í•˜ë©´ í˜ì´ì§€ ì¡°íšŒìˆ˜ë¥¼ ì¸¡ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><strong>pages/_app.tsx</strong></p>\n<deckgo-highlight-code language=\"tsx\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">import { useEffect } from &#39;react&#39;;\nimport { useRouter } from &#39;next/router&#39;;\nimport type { AppProps } from &#39;next/app&#39;;\n\nimport * as ga from &#39;../lib/ga&#39;;\n\nfunction App({ Component, pageProps }: AppProps) {\n  const router = useRouter();\n\n  useEffect(() =&gt; {\n    const handleRouteChange = url =&gt; {\n      ga.pageview(url);\n    };\n    router.events.on(&#39;routeChangeComplete&#39;, handleRouteChange);\n\n    return () =&gt; {\n      router.events.off(&#39;routeChangeComplete&#39;, handleRouteChange);\n    };\n  }, [router.events]);\n\n  return &lt;Component {...pageProps} /&gt;;\n}\n\nexport default App;</code>\n        </deckgo-highlight-code>\n<p>JavaScript í”„ë¡œì íŠ¸ì—ì„œëŠ” AppProps ë¶€ë¶„ì„ ì œì™¸í•˜ê³  ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>\n<p><strong>pages/_app.jsx</strong></p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">import { useEffect } from &#39;react&#39;;\nimport { useRouter } from &#39;next/router&#39;;\n\nimport * as ga from &#39;../lib/ga&#39;;\n\nfunction App({ Component, pageProps }) {\n  const router = useRouter();\n\n  useEffect(() =&gt; {\n    const handleRouteChange = url =&gt; {\n      ga.pageview(url);\n    };\n    router.events.on(&#39;routeChangeComplete&#39;, handleRouteChange);\n\n    return () =&gt; {\n      router.events.off(&#39;routeChangeComplete&#39;, handleRouteChange);\n    };\n  }, [router.events]);\n\n  return &lt;Component {...pageProps} /&gt;;\n}\n\nexport default App;</code>\n        </deckgo-highlight-code>\n<h2>[5] ë°°í¬ ì„¤ì •ì—ì„œ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€í•˜ê¸°</h2>\n<p><code>.env.local</code> íŒŒì¼ì— ì‘ì„±í•œ GA ì¶”ì  ì½”ë“œë¥¼ ë°°í¬ í™˜ê²½ì— ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. vercel ë°°í¬ í™˜ê²½ì—ì„œëŠ” <code>Settings > Environment Variables</code> í•­ëª© ì¤‘ NAME, VALUEë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤. NAMEì—ëŠ” <code>NEXT_PUBLIC_GOOGLE_ANALYTICS</code>ë¥¼, VALUEì—ëŠ” <code>GA ì¶”ì  ì½”ë“œ</code>ë¥¼ ì‘ì„±í•˜ì‹œë©´ ë©ë‹ˆë‹¤. 1ë²ˆ NEXT_PUBLIC_GOOGLE_ANALYTICS=â€œcodeâ€ì—ì„œ ì‘ì„±í•œ â€œcodeâ€ ê°’ê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><img src=\"https://images.velog.io/images/mnz/post/22c0a310-86d8-44db-b544-9eb623a56be9/image.png\" alt=\"vercel\"></p>\n<h1>ë§ˆì¹˜ë©°</h1>\n<p>ì´ë ‡ê²Œ 5ë‹¨ê³„ê¹Œì§€ ì™„ë£Œí•˜ë©´ Google Analyticsì—ì„œ ì‚¬ì´íŠ¸ ì¡°íšŒìˆ˜ë¥¼ ì¸¡ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ¤— ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê²€ìƒ‰ì–´ì™€ ê°™ì€ ì´ë²¤íŠ¸ ì¸¡ì • ê¸°ëŠ¥ ìƒì„± ë°©ë²•ì´ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ <a href=\"https://mariestarck.com/add-google-analytics-to-your-next-js-application-in-5-easy-steps/\" target=\"_blank\" rel=\"nofollow\">Add Google Analytics to your Next.js application in 5 easy steps</a>ì—ì„œ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ì‹œëŠ” ê±¸ ì¶”ì²œí•©ë‹ˆë‹¤!</p>\n<hr />\n<h3>ì°¸ê³  ìë£Œ ğŸ“©</h3>\n<ul>\n<li>\n<p><a href=\"https://mariestarck.com/add-google-analytics-to-your-next-js-application-in-5-easy-steps/\" target=\"_blank\" rel=\"nofollow\">Add Google Analytics to your Next.js application in 5 easy steps</a></p>\n</li>\n<li>\n<p><a href=\"https://velog.io/@kineo2k/Typescript%EC%97%90%EC%84%9C-window-%EA%B0%9D%EC%B2%B4%EC%97%90-property-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" target=\"_blank\" rel=\"nofollow\">Typescriptì—ì„œ window ê°ì²´ì— property ì¶”ê°€í•˜ê¸°</a></p>\n</li>\n</ul>","timeToRead":3,"frontmatter":{"title":"[NextJS] Next í”„ë¡œì íŠ¸ì—ì„œ Google Analytics ì ìš©í•˜ê¸°","summary":"Next í”„ë¡œì íŠ¸ì—ì„œ react-ga ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ Google Analyticsë¥¼ ì ìš©í•˜ê³  ì›¹ ì‚¬ì´íŠ¸ ì¡°íšŒìˆ˜ë¥¼ ì•Œì•„ë³´ëŠ” ë°©ë²•ì— ëŒ€í•´ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.","date":"31 August, 2021","category":"NextJS","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAClElEQVQozyXM21IaBwCA4X2EznSmEzVaggzoclgKwYhpDA4bQE7LihAXMMtBgiIVVo67HEuSphehM20v2j7t35nk4rv9hOVyxfrDJ+bLNdZ8xefPv7P58oWPHz+RVYvIiSxJ5ZJsXqNQqlKqttD0JqVai+tmm+ubNuXGHW/1JvlyHUFvdtBbHW7uDe56I6bLNX9sNmw2G27et0nliqjFMmqhTFIpEIkmiKVU4ukL5HOFo5MIUuAY0RPEvn+IkFaLpAslSo07brsDcm/LpHMqXcMglVHwSwFcLjcOxwFBrwevy0k8Fmd76yk22z6iS8Rpt2Pf3WPvyTZC8Urj6l2Dvrmg1RsiJzPYD9wc+vx0fnmgrldJxOIo6Qyjzi2akuEyp5BT88hRmZgcQY4cE5fP8B26EfIXeWKpLLcPfS60Cj+fRTnwSLhED7VGk/VqxftanXpJYz40uC7kOT0KsfrwG4PRGKfNxv7uLolYgkpFR4jLb0hlsoTCYZxu71fBFyf4Qy8QfX4KhQK5TJpjr0jyNEzY7+P06DmT2YLe4wCHzYZte5tkPMbYnCIEfBLqxSV7NjtPnznY2n3GmRzDeBzw519/88+//2GaFtZ4xMwc89C+o1qp0L2/57Uk4vr+O3w/7vCuVGQ2XyDs/PCEbEZha2cP6acgV1cak4mJac3Q602isXMkKUAwECKVVqjVb9C0CrlMlkTkNa+8HopZhZG1wJwuEHziITVd57E/ZDqb03nokc7lCYRO8EjPCYaOOXl5ipov0mi16fT6DM0Z1nKNufgVY2zRHZoMJ1PM6RLhPPoKNXNOtVZHLWi8jLzB7QvgcIoEQ2GKpWs6xgBjZH7N7ruPGMMJg4nFyJwynFj0x9/CibXgfwjIixlv2SmBAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/4107247d1d1486ea9e84689bc9386d4e/25b42/google-analytics.png","srcSet":"/static/4107247d1d1486ea9e84689bc9386d4e/f144d/google-analytics.png 183w,\n/static/4107247d1d1486ea9e84689bc9386d4e/50beb/google-analytics.png 365w,\n/static/4107247d1d1486ea9e84689bc9386d4e/25b42/google-analytics.png 730w","sizes":"(min-width: 730px) 730px, 100vw"},"sources":[{"srcSet":"/static/4107247d1d1486ea9e84689bc9386d4e/c97dd/google-analytics.webp 183w,\n/static/4107247d1d1486ea9e84689bc9386d4e/2772f/google-analytics.webp 365w,\n/static/4107247d1d1486ea9e84689bc9386d4e/c85f2/google-analytics.webp 730w","type":"image/webp","sizes":"(min-width: 730px) 730px, 100vw"}]},"width":730,"height":365}},"publicURL":"/static/4107247d1d1486ea9e84689bc9386d4e/google-analytics.png"}}}}]}},"pageContext":{"slug":"/nextjs/google-analytics/"}},
    "staticQueryHashes": ["2368566813","3026479947","3227158195","413061808"]}