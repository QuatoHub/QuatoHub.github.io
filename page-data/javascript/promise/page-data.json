{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/javascript/promise/",
    "result": {"data":{"posts":{"edges":[{"node":{"id":"cdfb7ab9-3373-5ee0-ac92-bbe97818d727","html":"<h1>들어가며</h1>\n<p><a href=\"https://learnjs.vlpt.us/async/\" target=\"_blank\" rel=\"nofollow\">자바스크립트에서 비동기 처리 다루기</a>와 <a href=\"https://joshua1988.github.io/web-development/javascript/promise-for-beginners/\" target=\"_blank\" rel=\"nofollow\">자바스크립트 Promise 쉽게 이해하기</a>를 읽고 정리한 글입니다. <strong>Promise 의 개념</strong>과 <code>resolve</code>, <code>reject</code>에서 <strong>에러 처리 방법</strong> 및 <strong>Promise.all()</strong>, <strong>Promise.race()</strong>, <strong>Promise.finally()</strong> 에 대해 작성했습니다.</p>\n<h1>📝 Promise 정의</h1>\n<p>MDN 사이트의 Promise 정의 <a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Promise\" target=\"_blank\" rel=\"nofollow\">Promise - JavaScript | MDN</a></p>\n<blockquote>\n<p>Promise 객체는 비동기 작업이 맞이할 미래의 완료 또는 실패와 그 결과의 값을 나타냅니다.</p>\n</blockquote>\n<p>이전에 비동기 작업을 처리할 때는 콜백 함수로 처리를 해야 했는데요, 콜백 함수로 처리를 하게 된다면 비동기 작업이 많아질 경우 코드가 쉽게 난잡해졌습니다. Promise 를 이용하면 비동기적인 상황에서 코드를 조금 더 명확하게 표현하고 실행하도록 만들 수 있습니다.</p>\n<h2>🐾 전역 객체</h2>\n<p>Promise 를 <code>import</code>를 하지 않아도 Node.js 런타임 환경에서 전역 객체 Promise 를 확인할 수 있습니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">console.log(Promise);</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\n[Function: Promise]</code>\n        </deckgo-highlight-code>\n<h2>✍ 생성자로 Promise 객체 만들기 (pending)</h2>\n<p>생성자의 인자로 <code>executor</code>함수를 사용합니다. 생성자를 통해서 Promise 객체를 만드는 순간 pending (대기) 상태라고 합니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">const myPromise = new Promise(/* executor */);</code>\n        </deckgo-highlight-code>\n<h1>🏃‍♀️ executor 함수의 형태</h1>\n<p><code>executor</code>함수는 <code>resolve</code>와 <code>reject</code>를 인자로 가집니다. <code>executor</code>함수의 형태는 다음 코드와 같습니다.여기서 <code>resolve</code>와 <code>reject</code>는 함수입니다. Promise 는 성공할 수도 있고, 실패 할 수도 있습니다. 성공할 때는 <code>resolve</code>를 호출해주면 되고, 실패할 때에는 <code>reject</code>를 호출해주면 됩니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">(resolve, reject) =&gt; {...}</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">const myPromise = new Promise(/* executor */ (resolve, reject) =&gt; {...});</code>\n        </deckgo-highlight-code>\n<h2>😄 Promise 의 resolve (fulfilled)</h2>\n<p>위에서 Promise 객체를 만드는 순간 pending (대기) 상태라고 했는데, <code>executor</code>함수 인자 중 하나인 <code>resolve</code>함수를 실행하면, fulfilled (이행) 상태가 됩니다. 이행 상태라는 것은 실행됐다는 걸 알려주는 상태입니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">const myPromise = new Promise((resolve, reject) =&gt; {\n  // .. panding 상태\n  // .. 비동기 처리 상황\n  // .. 비동기 처리가 정상적으로 완료된 후 resolve 호출\n  resolve();\n  // .. fulfilled 상태\n});</code>\n        </deckgo-highlight-code>\n<h2>😥 Promise 의 reject (rejected)</h2>\n<p><code>executor</code>함수의 다른 인자 <code>reject</code>함수를 실행하면, rejected (거부) 상태가 됩니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">const myPromise = new Promise((resolve, reject) =&gt; {\n  // .. panding 상태\n  // .. 비동기 처리 상황\n  // .. 비동기 처리 중 에러 상황 발생\n  reject();\n  // .. rejected 상태\n});</code>\n        </deckgo-highlight-code>\n<h1>🎡 .then 으로 작업 관리하기</h1>\n<p>Promise 객체가 fulfilled 상태가 됐을 때 (다음 코드 기준으로 1초가 지났을 때) <code>then</code>안에 <code>callback</code> 함수를 실행합니다. 작업이 끝나고 나서 또 다른 작업을 해야 할 때는 Promise 뒤에 <code>.then(...)</code>을 붙여서 사용하면 됩니다. <code>resolve</code>를 호출할 때 특정 값을 파라미터로 넣어주면, 이 값을 작업이 끝나고 나서 사용할 수 있습니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function myPromise() {\n  return new Promise((resolve, reject) =&gt; {\n    // .. pending\n    setTimeout(() =&gt; {\n      resolve(&#39;민지&#39;);\n      // .. fulfilled\n    }, 1000);\n  });\n}\n\nmyPromise().then(message =&gt; {\n  console.log(&#39;안녕하세요,&#39;, message, &#39;님&#39;);\n});</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\n안녕하세요, 민지 님</code>\n        </deckgo-highlight-code>\n<h2>📆 Promise .finally()</h2>\n<p>fulfilled 나 rejected 이후 실행할 것이 있다면, <code>.finally()</code>를 설정하고 함수를 인자로 넣습니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function myPromise() {\n  return new Promise((resolve, reject) =&gt; {\n    // .. pending\n    setTimeout(() =&gt; {\n      reject(new Error(&#39;error&#39;));\n      // .. rejected\n    }, 1000);\n  });\n}\n\nmyPromise()\n  .then(message =&gt; {\n    console.log(&#39;안녕하세요,&#39;, message);\n  })\n  .catch(error =&gt; {\n    console.log(error);\n  })\n  .finally(() =&gt; {\n    console.log(&#39;finally&#39;);\n  });</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\nError: error\n    at Timeout._onTimeout (에러-파일-경로/index.js:5:14)\n    at listOnTimeout (internal/timers.js:549:17)\n    at processTimers (internal/timers.js:492:7)\nfinally</code>\n        </deckgo-highlight-code>\n<h1>🚨 catch 로 Error 확인하기</h1>\n<p>Promise 객체가 rejected 상태가 됐을 때 (다음 코드 기준으로 1초가 지났을 때) <code>catch</code>안에 <code>callback</code>함수를 실행합니다. 실패하는 상황에서는 reject 를 사용하고, <code>.catch</code>를 통하여 실패했을 시 수행할 작업을 설정할 수 있습니다. reject 함수에 인자를 작성하면 <code>callback</code>함수에서 사용할 수 있습니다. Promise catch 로 Error 확인할 때 일반적으로 표준 내장 객체인 Error 의 생성자를 이용하여 Error 객체를 만들어 사용합니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function myPromise() {\n  return new Promise((resolve, reject) =&gt; {\n    // .. pending\n    setTimeout(() =&gt; {\n      reject(new Error(&#39;error&#39;));\n      // .. rejected\n    }, 1000);\n  });\n}\n\nmyPromise()\n  .then(message =&gt; {\n    console.log(&#39;안녕하세요,&#39;, message);\n  })\n  .catch(error =&gt; {\n    console.log(error);\n  });</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\nError: error\n    at Timeout._onTimeout (에러-파일-경로/index.js:5:14)\n    at listOnTimeout (internal/timers.js:549:17)\n    at processTimers (internal/timers.js:492:7)</code>\n        </deckgo-highlight-code>\n<h2>🤗 코드 길이 줄이기</h2>\n<p>위에 정리한 내용을 적용해서 코드 길이를 줄여보겠습니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function increaseAndPrint(n) {\n  return new Promise((resolve, reject) =&gt; {\n    setTimeout(() =&gt; {\n      const value = n + 1;\n\n      if (value === 5) {\n        const error = new Error();\n\n        error.name = &#39;ValueIsFiveError&#39;;\n\n        reject(error);\n\n        return;\n      }\n\n      console.log(value);\n\n      resolve(value);\n    }, 1000);\n  });\n}\n\nincreaseAndPrint(0)\n  .then(n =&gt; {\n    return increaseAndPrint(n);\n  })\n  .then(n =&gt; {\n    return increaseAndPrint(n);\n  })\n  .then(n =&gt; {\n    return increaseAndPrint(n);\n  })\n  .then(n =&gt; {\n    return increaseAndPrint(n);\n  })\n  .then(n =&gt; {\n    return increaseAndPrint(n);\n  })\n  .catch(e =&gt; {\n    console.error(e);\n  });</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function increaseAndPrint(n) {\n  return new Promise((resolve, reject) =&gt; {\n    setTimeout(() =&gt; {\n      const value = n + 1;\n\n      if (value === 5) {\n        const error = new Error();\n\n        error.name = &#39;ValueIsFiveError&#39;;\n\n        reject(error);\n\n        return;\n      }\n\n      console.log(value);\n\n      resolve(value);\n    }, 1000);\n  });\n}\n\nincreaseAndPrint(0)\n  .then(increaseAndPrint)\n  .then(increaseAndPrint)\n  .then(increaseAndPrint)\n  .then(increaseAndPrint)\n  .then(increaseAndPrint)\n  .catch(e =&gt; {\n    console.error(e);\n  });</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\nError [ValueIsFiveError]\n    at Timeout._onTimeout (에러-파일-경로/index.js:6:23)\n    at listOnTimeout (internal/timers.js:549:17)\n    at processTimers (internal/timers.js:492:7)</code>\n        </deckgo-highlight-code>\n<h2>😤 위 코드에서 사용하기 불편한 점</h2>\n<ol>\n<li>\n<p>에러를 잡을 때 여러 .then 중 <strong>어떤 부분에서 발생한 error 인지 파악하기 어려움</strong></p>\n</li>\n<li>\n<p>특정 조건에 따라 <strong>분기를 나누기 어려움</strong></p>\n</li>\n</ol>\n<h1>🎊 불편함을 해결하기 위한 async / await</h1>\n<p>async / await 문법을 사용할 때에는, 함수를 선언할 때 함수의 앞부분에 async 키워드를 작성합니다. 그리고 Promise 의 앞부분에 await 을 넣어주면 해당 Promise 가 끝날 때까지 기다렸다가 다음 작업을 수행할 수 있습니다. <strong>함수에서 async 를 사용하면, 해당 함수는 결괏값으로 Promise 를 반환하게 됩니다.</strong></p>\n<h2>🎯 throw 와 try / catch 로 에러 다루기</h2>\n<p>async 함수에서 에러를 발생시킬 때에는 throw 를 사용하고, 에러를 잡아낼 때는 try/catch 문을 사용합니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function sleep(ms) {\n  return new Promise(resolve =&gt; setTimeout(resolve, ms));\n}\n\nasync function makeError() {\n  await sleep(1000);\n\n  const error = new Error();\n\n  throw error;\n}\n\nasync function process() {\n  try {\n    await makeError();\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nprocess();</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\nError\n    at makeError (에러-파일-경로/index.js:8:17)\n    at async process (에러-파일-경로/index.js:15:5)</code>\n        </deckgo-highlight-code>\n<h2>🐢 Promise .all()</h2>\n<p>프로미스 객체를 여러 개 생성하여, 배열로 만들어 인자로 넣고 Promise.all 을 실행하면, 배열의 모든 프로미스 객체들이 fulfilled 되었을 때, <code>then</code>의 함수가 실행됩니다. 동시에 작업을 시작하고 싶을 때 사용할 수 있습니다. <code>then</code>함수의 인자로 프로미스 객체들의 resolve 인자값의 배열을 돌려줍니다. 등록한 Promise 중 하나라도 실패하면, 모든 게 실패한 것으로 간주합니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function sleep(ms) {\n  return new Promise(resolve =&gt; setTimeout(resolve, ms));\n}\n\nconst getDog = async () =&gt; {\n  await sleep(1000);\n  return &#39;멍멍이&#39;;\n};\n\nconst getRabbit = async () =&gt; {\n  await sleep(500);\n  return &#39;토끼&#39;;\n};\n\nconst getTurtle = async () =&gt; {\n  await sleep(3000);\n  return &#39;거북이&#39;;\n};\n\nasync function process() {\n  const results = await Promise.all([getDog(), getRabbit(), getTurtle()]);\n  console.log(results);\n}\n\nprocess();</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\n[ &#39;멍멍이&#39;, &#39;토끼&#39;, &#39;거북이&#39; ]</code>\n        </deckgo-highlight-code>\n<h2>🐇 Promise .race()</h2>\n<p>Promise 객체 여러 개를 생성하여, 배열로 만들고 인자로 사용해서 Promise.race 를 실행했습니다. 배열의 모든 Promise 객체 중 가장 먼저 fulfilled 된 것으로, <code>then</code>의 함수를 실행합니다. 가장 빨리 끝난 것 하나만의 결괏값을 가져옵니다. 다른 Promise 가 먼저 성공하기 전에 가장 먼저 끝난 Promise 가 실패하면 이를 실패로 간주합니다. 따라서, 가장 먼저 끝난 Promise 에서 에러를 발생시킨다면 에러를 잡아낼 수 있지만, 이후 Promise 에서 발생한 에러는 무시됩니다.</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">function sleep(ms) {\n  return new Promise(resolve =&gt; setTimeout(resolve, ms));\n}\n\nconst getDog = async () =&gt; {\n  await sleep(1000);\n  return &#39;멍멍이&#39;;\n};\n\nconst getRabbit = async () =&gt; {\n  await sleep(500);\n  return &#39;토끼&#39;;\n};\nconst getTurtle = async () =&gt; {\n  await sleep(3000);\n  return &#39;거북이&#39;;\n};\n\nasync function process() {\n  const first = await Promise.race([getDog(), getRabbit(), getTurtle()]);\n\n  console.log(first);\n}\n\nprocess();</code>\n        </deckgo-highlight-code>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">$ node index.js\n토끼</code>\n        </deckgo-highlight-code>\n<h1>마치며</h1>\n<p>Promise 의 개념과 resolve, reject 에서 에러 처리 방법 설명 및 Promise.all(), Promise.race(), Promise.finally() 에 대해 정리했습니다. resolve 함수를 실행하면 fulfilled 상태, reject 함수를 실행하면 rejected 상태입니다. 에러를 처리할 때는 주로 catch 를 사용합니다. <strong>Promise.all()</strong> 에서는 배열의 모든 Promise 객체들이 fulfilled 되었을 때 then 함수를 실행하고 <strong>Promise.race()</strong> Promise 객체 중 가장 먼저 fulfilled 된 것으로 then 함수를 실행합니다. <strong>Promise.finally()</strong> 는 fulfilled 나 rejected 이후 실행할 것이 있을 때 사용합니다.</p>\n<hr />\n<h3>참고 자료 📩</h3>\n<ul>\n<li>\n<p><a href=\"https://learnjs.vlpt.us/async/\" target=\"_blank\" rel=\"nofollow\">자바스크립트에서 비동기 처리 다루기</a></p>\n</li>\n<li>\n<p><a href=\"https://joshua1988.github.io/web-development/javascript/promise-for-beginners/\" target=\"_blank\" rel=\"nofollow\">자바스크립트 Promise 쉽게 이해하기</a></p>\n</li>\n</ul>","timeToRead":6,"frontmatter":{"title":"[JavaScript] Promise란?","summary":"Promise의 개념과 resolve, reject에서 에러 처리 방법 및 Promise.all(), Promise.race(), Promise.finally()에 대해 작성했습니다.","date":"24 April, 2021","category":"JavaScript","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB5ElEQVQoz13SS0/bQBSG4azbBF/m6sv4EpNgojawBFMJKpUmEFVFpV0RFVYs2i7L73+rcRJEWczCls/j8505gyK3KCUQIkZKQRSF1FVFe9ASRRFSCIwypCYj1SlZWqCVQUm9qRExcRyRJZrSWQaFs+j/wIBxPWb+/hgpJEpKtNIYaahcQ1mNyXLXo3ILijgiTRRV4cH8FRgGHExb2vYd1iTEUczwzVv2hgEqskipCcMYLW3//Utw0+Er0Eccj/e5vf3B7bfvdKcdN19vWC6u+Hj+ievFii/XN5R53Uf1NR5M7BZ0mdmA8QaM45CiLrhb3/H4+MjP+3seHh5Yr9dcfr7k79MTv3/9IbPuucaD1ki8NchSvQUjlBSMRkO67ox2NiNJEg5nM3KXU1Ul1lrm82Pa6ZQgCFBKbiPHWL0F00T30K790fAtp13HQXtI0zRcXJyzWC5YXi1ZrVacnJzStm0/a/VihkZL8lRvQK1lvzpaSYK9Ed2Hs74zbSxJlhMLQRiGhEHAZDKlKIt+vXbYDkytZuCHmVqvK1ymyRJJ09Q4lzM/OuovZbJfMa5rxpMpaZr2Uf3Pd5i/UP+cGMXAy0r6NdgcP1zfsTGKsshoakdTF5SlwxWuf++Pteo5cr8dUqC14B93/A6YwckAewAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/b3b1be205f48806ad85d92b86b5b30c7/25b42/promise.png","srcSet":"/static/b3b1be205f48806ad85d92b86b5b30c7/f144d/promise.png 183w,\n/static/b3b1be205f48806ad85d92b86b5b30c7/50beb/promise.png 365w,\n/static/b3b1be205f48806ad85d92b86b5b30c7/25b42/promise.png 730w","sizes":"(min-width: 730px) 730px, 100vw"},"sources":[{"srcSet":"/static/b3b1be205f48806ad85d92b86b5b30c7/c97dd/promise.webp 183w,\n/static/b3b1be205f48806ad85d92b86b5b30c7/2772f/promise.webp 365w,\n/static/b3b1be205f48806ad85d92b86b5b30c7/c85f2/promise.webp 730w","type":"image/webp","sizes":"(min-width: 730px) 730px, 100vw"}]},"width":730,"height":365}},"publicURL":"/static/b3b1be205f48806ad85d92b86b5b30c7/promise.png"}}}}]}},"pageContext":{"slug":"/javascript/promise/"}},
    "staticQueryHashes": ["2368566813","3026479947","3227158195","413061808"]}