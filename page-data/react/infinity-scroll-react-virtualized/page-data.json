{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/react/infinity-scroll-react-virtualized/",
    "result": {"data":{"posts":{"edges":[{"node":{"id":"1aa692a6-b165-5277-88ba-a1c175a565f2","html":"<h1>들어가며</h1>\n<p>React 공식 문서에서 소개하는 <strong>react-virtualized 라이브러리를 사용한 Infinity Scroll 최적화</strong> 포스팅입니다. <strong>windowing 기법</strong>과 <strong>크롬 개발자 도구를 활용한 성능 측정 방법</strong>에 대해 먼저 알아본 후 react-virtualized 라이브러리 사용 방법을 소개합니다. 본 포스팅에서 다루는 To Do List 예제는 <a href=\"https://github.com/velopert/learning-react\" target=\"_blank\" rel=\"nofollow\">리액트를 다루는 기술</a> 코드를 사용했습니다.</p>\n<h1>1. react-virtualized 가 무엇인가요? 🎠</h1>\n<p><img src=\"https://images.velog.io/images/mnz/post/df9c8cec-26f2-45b2-a231-9fc16ffa8c27/image.png\" alt=\"img\"></p>\n<p>react-virtualized 란 React 공식 문서 <a href=\"https://ko.reactjs.org/docs/optimizing-performance.html\" target=\"_blank\" rel=\"nofollow\">성능 최적화 페이지</a>에서 소개하는 두 개의 라이브러리 중 하나입니다.</p>\n<blockquote>\n<p>react-virtualized 를 널리 알려진 windowing 라이브러리라고 소개하고 있습니다.</p>\n</blockquote>\n<p>여기서 <strong>windowing 기법</strong>이란 무엇일까요?</p>\n<p>React 공식 문서에는 이렇게 적혀 있습니다.</p>\n<blockquote>\n<p>주어진 시간에 목록의 부분 목록만 렌더링하며 컴포넌트를 다시 렌더링하는 데 걸리는 시간과 생성된 DOM 노드의 수를 크게 줄일 수 있습니다.</p>\n</blockquote>\n<p>windowing 기법에 대해 조금 더 자세히 알아보겠습니다.</p>\n<h2>1-1. windowing 기법 🏄‍♀️</h2>\n<p><img src=\"https://addyosmani.com/assets/images/react-window.png\" alt=\"windowing\"></p>\n<p>많은 데이터를 list 로 만들고 초기 렌더링에 모든 데이터를 불러오려면 굉장히 오랜 시간이 걸립니다. 사용자로서 긴 렌더링 시간이 불편하게 느껴질 수 있습니다.</p>\n<blockquote>\n<p>이를 해결하기 위해서 <strong>list 중 viewport 에 보이는 부분만 렌더링하고 나머지는 스크롤 할 때 보이도록 하는 것</strong>을 권장합니다.</p>\n</blockquote>\n<p>그리고 이 방법을 windowing 기법이라고 합니다.</p>\n<h2>1-2. react-virtualized 를 선택한 이유 🚩</h2>\n<p>위에서 react-virtualized 에 대해 작성할 때 React 공식 문서에서 소개하는 두 개의 라이브러리 중 하나라고 했는데, 다른 하나는 react-window 라이브러리입니다. 이 포스팅에서 react-window 가 아닌 react-virtualized 를 다루는 이유는 다음과 같습니다.</p>\n<p><img src=\"https://images.velog.io/images/mnz/post/ef0fbdf3-4382-4099-a357-bb72a43c5ac1/%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C.png\" alt=\"virtualized\"></p>\n<blockquote>\n<p>react-virtualized 사용자</p>\n</blockquote>\n<p>위 사진은 최근 6개월 동안 react-virtualized 와 react-window 의 다운로드 횟수를 나타낸 것입니다. react-virtualized 패키지의 사용자가 더 많은 것을 확인할 수 있습니다. 또한, react-virtualized 에는 react-window 에 없는 기능이 있는데 그중 두 가지는 아래와 같습니다.</p>\n<blockquote>\n<p>window 스크롤</p>\n</blockquote>\n<p>react-window 는 컨테이너의 너비와 높이를 명시적으로 지정하여 해당 컨테이너 내에서만 가상화가 가능합니다. react-virtualized 의 WindowScroller 컴포넌트를 사용하면 페이스북이나 트위터처럼 <strong>window 스크롤을 기준으로 목록이 가상화되도록 구현</strong>할 수 있습니다.</p>\n<blockquote>\n<p>요소의 동적인 height 측정</p>\n</blockquote>\n<p>콘텐츠형 광고 페이지 내에서 렌더링 되는 요소의 <code>height</code>값은 요소의 내용에 따라 변하기 때문에 동적인 <code>height</code>을 측정할 수 있어야 합니다. react-window 는 요소의 동적인 <code>height</code>값을 측정할 방법이 없지만, react-virtualized 에서 <code>CellMeasurer</code>라는 컴포넌트는 <strong>원하는 요소의 동적인 height 값을 측정</strong>해주는 역할을 담당하고 있습니다. 동적인 height 값에 대해서는 <a href=\"http://bvaughn.github.io/react-virtualized/#/components/List\" target=\"_blank\" rel=\"nofollow\">react-virtualized</a> 링크에서 확인할 수 있습니다.</p>\n<blockquote>\n<p>그러나 위 사진의 size 항목에서 확인할 수 있는 거처럼 react-window 가 react-virtualized 보다 훨씬 작아서 추가적인 기능을 사용하지 않는다면 react-window 사용을 권장하기도 합니다.</p>\n</blockquote>\n<h1>2. 크롬 개발자 도구로 성능 측정하는 방법 💫</h1>\n<p>성능을 분석해야 할 때는 느려졌다는 느낌이 아니라 정확히 몇 초가 걸리는지 확인이 필요합니다. 크롬 개발자 도구의 <strong>Performance 탭</strong>으로 이를 측정할 수 있습니다.</p>\n<p><img src=\"https://images.velog.io/images/mnz/post/2ef83db4-a3a4-4f9f-be08-71fbcdb5d085/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202021-05-30%20202801.png\" alt=\"performance\"></p>\n<p>녹화 버튼을 클릭한 후, 할 일 목록에 체크하고 화면에 변화가 반영되면 Stop 버튼을 누릅니다.</p>\n<blockquote>\n<p>성능 분석 결과에 나타나는 Timings 를 열어 보면 각 시간대에 컴포넌트의 어떤 작업이 처리되었는지 확인할 수 있습니다.</p>\n</blockquote>\n<p>App [update] 박스를 열어 작업 처리 시간을 확인했습니다. 2500개의 데이터가 있는데 1.4초가 걸린다는 것은 성능이 매우 나쁘다는 의미입니다. 최적화를 한 이후 이 성능을 비교해보겠습니다.</p>\n<h1>3. react-virtualized 사용 방법 🚀</h1>\n<h2>3-1. 패키지 설치 💾</h2>\n<p>우선 yarn 을 통해 react-virtualized 를 설치하겠습니다.</p>\n<deckgo-highlight-code language=\"shell\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">yarn add react-virtualized</code>\n        </deckgo-highlight-code>\n<p>이제 react-virtualized 에서 제공하는 List 컴포넌트를 사용하여 To Do List 컴포넌트 성능 최적화를 하겠습니다.</p>\n<h2>3-2. 각 항목의 px 단위 측정하기 🎨</h2>\n<p>최적화를 수행하기 전에 필요한 작업은 각 항목의 실제 크기를 px 단위로 알아내는 것입니다. <strong>크롬 개발자 도구</strong>를 통해 이 크기를 쉽게 알아낼 수 있습니다.</p>\n<p><img src=\"https://images.velog.io/images/mnz/post/1a645131-2bbe-4d51-ab25-5222a19087d4/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202021-05-30%20195109.png\" alt=\"px\"></p>\n<p>각 항목의 크기는 가로 <code>495px</code>, 세로 <code>57px</code>입니다. 여기서 첫 번째 항목이 아니라 두 번째 항목을 확인하는 이유는 테두리가 포함된 값을 알아내기 위해서입니다.</p>\n<h2>3-3. 코드 수정하기 🧙‍♂️</h2>\n<blockquote>\n<p>예시 코드 구조</p>\n</blockquote>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">src\n ┣ components\n ┃ ┣ TodoInsert.js\n ┃ ┣ TodoInsert.scss\n ┃ ┣ TodoList.js\n ┃ ┣ TodoList.scss\n ┃ ┣ TodoListItem.js\n ┃ ┣ TodoListItem.scss\n ┃ ┣ TodoTemplate.js\n ┃ ┗ TodoTemplate.scss\n ┣ App.css\n ┣ App.js\n ┣ App.test.js\n ┣ index.css\n ┣ index.js\n ┣ logo.svg\n ┗ serviceWorker.js</code>\n        </deckgo-highlight-code>\n<blockquote>\n<p>수정 전 To Do List 코드</p>\n</blockquote>\n<deckgo-highlight-code language=\"jsx\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">import React from &#39;react&#39;;\nimport TodoListItem from &#39;./TodoListItem&#39;;\nimport &#39;./TodoList.scss&#39;;\n\nconst TodoList = ({ todos, onRemove, onToggle }) =&gt; {\n  return (\n    &lt;div className=&quot;TodoList&quot;&gt;\n      {todos.map(todo =&gt; (\n        &lt;TodoListItem\n          todo={todo}\n          key={todo.id}\n          onRemove={onRemove}\n          onToggle={onToggle}\n        /&gt;\n      ))}\n    &lt;/div&gt;\n  );\n};\n\nexport default TodoList;</code>\n        </deckgo-highlight-code>\n<blockquote>\n<p>react-virtualized 를 적용한 To Do List 코드</p>\n</blockquote>\n<ul>\n<li>\n<p><code>useCallback</code>과 <code>memo</code>로 최적화를 한 이후에 react-virtualized 를 적용한 코드입니다.</p>\n</li>\n<li>\n<p>react-virtualized 관련 내용은 <code>return</code>문의 <code>List</code>컴포넌트입니다.</p>\n</li>\n</ul>\n<deckgo-highlight-code language=\"jsx\" terminal=\"carbon\" theme=\"seti\"  >\n          <code slot=\"code\">import React, { useCallback } from &#39;react&#39;;\nimport { List } from &#39;react-virtualized&#39;;\nimport TodoListItem from &#39;./TodoListItem&#39;;\nimport &#39;./TodoList.scss&#39;;\n\nconst TodoList = ({ todos, onRemove, onToggle }) =&gt; {\n  const rowRenderer = useCallback(\n    ({ index, key, style }) =&gt; {\n      const todo = todos[index];\n      return (\n        &lt;TodoListItem\n          todo={todo}\n          key={key}\n          onRemove={onRemove}\n          onToggle={onToggle}\n          style={style}\n        /&gt;\n      );\n    },\n    [onRemove, onToggle, todos],\n  );\n  return (\n    &lt;List\n      className=&quot;TodoList&quot;\n      width={495} // 전체 크기\n      height={513} // 전체 높이\n      rowCount={todos.length} // 항목 개수\n      rowHeight={57} // 항목 높이\n      rowRenderer={rowRenderer} // 항목을 렌더링할 때 쓰는 함수\n      list={todos} // 배열\n      style={{ outline: &#39;none&#39; }} // List에 기본 적용되는 outline 스타일 제거\n    /&gt;\n  );\n};\n\nexport default React.memo(TodoList);</code>\n        </deckgo-highlight-code>\n<p><code>List</code>컴포넌트를 사용하기 위해 <code>rowRenderer</code>라는 함수를 새로 작성했습니다. 이 함수는 react-virtualized 의 <code>List</code>컴포넌트에서 각 To Do Item을 렌더링할 때 사용하며, 이 함수를 <code>List</code>컴포넌트의 <code>props</code>값으로 설정해야 합니다. 이 함수는 파라미터에 <code>index</code>, <code>key</code>, <code>style</code>값을 객체 타입으로 받아 와서 사용합니다.</p>\n<blockquote>\n<p>List 컴포넌트를 사용할 때는 <strong>해당 리스트의 전체 크기와 각 항목의 높이, 각 항목을 렌더링할 때 사용해야 하는 함수, 그리고 배열</strong>을 <code>props</code>로 넣어 주어야 합니다.</p>\n</blockquote>\n<p>그러면 이 컴포넌트가 전달받은 <code>props</code>를 사용하여 자동으로 최적화를 해줍니다.</p>\n<h2>3-4. 최적화 이후 성능 비교 ✨</h2>\n<p><img src=\"https://images.velog.io/images/mnz/post/e3123f49-d18f-46b3-98a8-0d9e8e40980a/%ED%99%94%EB%A9%B4%20%EC%BA%A1%EC%B2%98%202021-05-30%20203601.png\" alt=\"ms\"></p>\n<blockquote>\n<p>최적화 이전에는 1.4초가 걸렸지만, 최적화 이후 11ms(0.011초) 가 걸리는 것을 확인할 수 있습니다. 👍</p>\n</blockquote>\n<p>현재 다룬 예시는 react-virtualized 만 적용했을 때 최적화 성능은 아니지만, 다른 예시를 통해 최적화 적용 순서대로 성능을 측정했을 때는 다음과 같습니다.</p>\n<ul>\n<li>\n<p>최적화 적용 전 코드: 1.02초</p>\n</li>\n<li>\n<p>React.memo 적용 코드: 0.059초</p>\n</li>\n<li>\n<p>react-virtualized 적용 코드: 0.005초</p>\n</li>\n</ul>\n<h1>마치며</h1>\n<p>react-virtualized 사용 방법에 대해 알아봤습니다. 리액트 컴포넌트의 렌더링은 기본적으로 빨라서 컴포넌트를 개발할 때 최적화 작업에 대해 너무 큰 스트레스를 받거나 모든 컴포넌트에 일일이 React.memo 를 작성할 필요는 없습니다. 단, 리스트와 관련된 컴포넌트를 만들 때 보여 줄 항목이 100개 이상이고 업데이트가 자주 발생한다면, 최적화가 필요합니다.</p>\n<hr />\n<h3>참고 자료 📩</h3>\n<ul>\n<li>\n<p><a href=\"https://yudhajitadhikary.medium.com/optimize-your-code-by-using-react-virtualized-a9c814031c27\" target=\"_blank\" rel=\"nofollow\">Optimize Your Code by using React Virtualized</a></p>\n</li>\n<li>\n<p><a href=\"https://ko.reactjs.org/docs/optimizing-performance.html\" target=\"_blank\" rel=\"nofollow\">성능 최적화</a></p>\n</li>\n<li>\n<p><a href=\"https://velog.io/@pandati0710/React-Windowing\" target=\"_blank\" rel=\"nofollow\">React Windowing</a></p>\n</li>\n<li>\n<p><a href=\"https://book.naver.com/bookdb/book_detail.nhn?bid=15372757\" target=\"_blank\" rel=\"nofollow\">리액트를 다루는 기술</a></p>\n</li>\n<li>\n<p><a href=\"https://maybe-b50.tistory.com/67\" target=\"_blank\" rel=\"nofollow\">windowing 라이브러리</a></p>\n</li>\n<li>\n<p><a href=\"https://jooonho.com/react/2020-10-18-optimizing-performance/\" target=\"_blank\" rel=\"nofollow\">Optimizing Performance</a></p>\n</li>\n<li>\n<p><a href=\"https://addyosmani.com/blog/react-window/\" target=\"_blank\" rel=\"nofollow\">Rendering large lists with react-window</a></p>\n</li>\n<li>\n<p><a href=\"https://uzihoon.com/post/ef453fd0-ab14-11ea-98ac-61734eebc216\" target=\"_blank\" rel=\"nofollow\">[번역] React의 성능을 최적화하는 10가지 방법</a></p>\n</li>\n<li>\n<p><a href=\"https://velog.io/@kimjh96/react-virtualized-%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94\" target=\"_blank\" rel=\"nofollow\">react-virtualized 를 활용한 렌더링 성능 최적화</a></p>\n</li>\n</ul>","timeToRead":6,"frontmatter":{"title":"[React] react-virtualized를 사용한 Infinity Scroll 최적화","summary":"react-virtualized 라이브러리를 사용한 Infinity Scroll 최적화 방법입니다. windowing 기법과 크롬 개발자 도구를 활용한 성능 측정 방법도 포함하고 있습니다.","date":"30 May, 2021","category":"React","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACKElEQVQoz0WRSW/cRhBGiRw8QzabTfbGpUkOZ5NGW+wkkCB5JEuWFEVSAsNHA3ZiZ/n/f+EFpm358FB1qVeFr6J+s4dtWpR1KGPJnUP5CmkdiVLEMmMqMyYiRVmN8paJEEzTlEkcE2tLtnNAVrVk2hPpxQ6um2OrGh96bNWgXUWS5SSZQlozklmDrkuUs6NsKr4IxWKN/OUMdXxBFuZEWjvmw5LFZo9mc4DbW2OGCrdsyINnaiSxzYhNxg/TKUKpcdEkEYjQI19eIm7/IN7ekISBKNWW4WiXzckB3dFAfzinXAeKztPvLnn3/gMvzy85OdtydfMrddePMcQiRa52kdsr4usHkrMr5HKXKNaa+WLNcv85YbWiHXr8bEasDWXb8eenv3n/18ex/v7mLb4JTIRk+vlCXyLPr0kurslOLzAhEMXOUNczuvmSOnRjfj50NP1A3Q2YqqUKLdpXI91iSRk6rPMkdSA9fEF6skXPF3idEyVOkzYrmh+3HP/8gsV6zfmrS/75719uf7vnp+NTLl/fcHF1zevbO+4eHrm7f2Szf8izJEVoR2I/P8tTlSWR8AZVD/jVEbPVDqGfjZfIwpJpR5pr0tyM/UhhSVVBnCqEzJGqwBpHG1ratifKmpJEGaS2iNwglCYtzJNQGf/EN2FhS1wdxiiq0FE0HcrVpEIRydIhw5JytY+rGoyvvw9rj9JfhV/7LLfYshmRuSEOA9NuRVKUpFLzP0/tCBPVM9HWAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/af34bfa2f2f1ece78f6b26110de3e37c/25b42/infinity-scroll-react-virtualized.png","srcSet":"/static/af34bfa2f2f1ece78f6b26110de3e37c/f144d/infinity-scroll-react-virtualized.png 183w,\n/static/af34bfa2f2f1ece78f6b26110de3e37c/50beb/infinity-scroll-react-virtualized.png 365w,\n/static/af34bfa2f2f1ece78f6b26110de3e37c/25b42/infinity-scroll-react-virtualized.png 730w","sizes":"(min-width: 730px) 730px, 100vw"},"sources":[{"srcSet":"/static/af34bfa2f2f1ece78f6b26110de3e37c/c97dd/infinity-scroll-react-virtualized.webp 183w,\n/static/af34bfa2f2f1ece78f6b26110de3e37c/2772f/infinity-scroll-react-virtualized.webp 365w,\n/static/af34bfa2f2f1ece78f6b26110de3e37c/c85f2/infinity-scroll-react-virtualized.webp 730w","type":"image/webp","sizes":"(min-width: 730px) 730px, 100vw"}]},"width":730,"height":365}},"publicURL":"/static/af34bfa2f2f1ece78f6b26110de3e37c/infinity-scroll-react-virtualized.png"}}}}]}},"pageContext":{"slug":"/react/infinity-scroll-react-virtualized/"}},
    "staticQueryHashes": ["2368566813","3026479947","3227158195","413061808"]}